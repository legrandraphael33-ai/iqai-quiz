<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>IQAI Test - I Quit AI</title>

<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">

<style>
*{box-sizing:border-box;margin:0;padding:0;}
:root{
  --title-font:'Press Start 2P', monospace;
  --body-font:'Inter', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
}
body{
  min-height:100vh;
  display:flex;
  flex-direction:column;
  align-items:center;
  background:linear-gradient(135deg,#f0c79e,#e3a56b);
  padding:20px;
  font-family:var(--body-font);
}

h1{
  font-family:var(--title-font);
  font-size:2.25em;
  margin-bottom:8px;
  text-align:center;
  white-space:nowrap;
}
h1 span{display:inline-block}
.title-sep{margin:0 10px;opacity:0}

p.subtitle{
  text-align:center;
  margin-bottom:24px;
  font-size:1.45em;
  font-weight:800;
  color:#fff;
}

.container{
  max-width:560px;width:100%;
  background:#fff;
  border-radius:18px;
  padding:26px;
  box-shadow:0 10px 28px rgba(0,0,0,.18);
}

.hidden{display:none}

/* === START SLIDER === */
#startSlider{
  position:relative;
  height:56px;
  background:#263238;
  border-radius:14px;
  overflow:hidden;
  user-select:none;
  touch-action:none;
}
#startSliderThumb{
  position:absolute;
  width:56px;height:56px;
  background:#ff8f00;
  border-radius:14px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:22px;
  font-weight:900;
  cursor:pointer;
}
#startSliderLabel{
  position:absolute;
  width:100%;
  line-height:56px;
  text-align:center;
  color:#fff;
  font-weight:900;
  opacity:.7;
}

/* === TIMER === */
#timer{
  text-align:center;
  font-weight:900;
  margin-bottom:10px;
}

/* === CURSOR BLINK === */
.cursor{
  animation:blink 1s steps(2,start) infinite;
}
@keyframes blink{
  0%,100%{opacity:1}
  50%{opacity:0}
}

/* === MOBILE TITLE === */
@media(max-width:420px){
  h1{font-size:1.45em}
  p.subtitle{font-size:1.15em}
}
</style>
</head>

<body>

<h1 id="title"></h1>
<p class="subtitle">I Quit AI</p>

<!-- START SCREEN -->
<div id="startScreen" class="container">
  <div id="startSlider">
    <div id="startSliderThumb">▶</div>
    <div id="startSliderLabel">Glisse pour démarrer</div>
  </div>
</div>

<!-- GAME -->
<div id="gameContainer" class="container hidden">
  <div id="quiz">
    <div id="timer"></div>
    <div id="questionContainer"></div>
    <div id="optionsContainer" class="options"></div>
    <button id="nextBtn" disabled>Suivant</button>
  </div>
</div>

<audio id="bootSound" preload="auto">
  <source src="Gameboy.mp3" type="audio/mpeg">
</audio>

<script>
/* === TITLE ANIMATION === */
const colors=["#FF4136","#FFDC00","#2ECC40","#0074D9","#FF851B","#B10DC9"];
const title=document.getElementById("title");

function animateTitle(){
  title.innerHTML="";
  const spans=[];
  const parts=["IQAI"," | ","TEST"];

  parts.forEach((p,idx)=>{
    p.split("").forEach(c=>{
      const s=document.createElement("span");
      s.textContent=c;
      if(c==="|"){
        s.className="title-sep";
      }else{
        s.style.opacity=0;
        spans.push(s);
      }
      title.appendChild(s);
    });
  });

  spans.forEach((s,i)=>{
    s.style.color=colors[i%colors.length];
    setTimeout(()=>{
      s.style.opacity=1;
    },140*i);
  });

  setTimeout(()=>{
    const sep=document.querySelector(".title-sep");
    sep.style.opacity=1;
    sep.classList.add("cursor");
  },140*spans.length+200);

  return 140*spans.length+300;
}

/* === START SLIDER === */
const slider=document.getElementById("startSlider");
const thumb=document.getElementById("startSliderThumb");
const startScreen=document.getElementById("startScreen");
const gameContainer=document.getElementById("gameContainer");
const bootSound=document.getElementById("bootSound");

let dragging=false,startX=0;

thumb.addEventListener("pointerdown",e=>{
  dragging=true;
  startX=e.clientX-thumb.offsetLeft;
  thumb.setPointerCapture(e.pointerId);
});

thumb.addEventListener("pointermove",e=>{
  if(!dragging)return;
  const max=slider.clientWidth-thumb.clientWidth;
  let x=e.clientX-startX;
  x=Math.max(0,Math.min(x,max));
  thumb.style.left=x+"px";
  if(x>=max-2){
    dragging=false;
    startGameFlow();
  }
});

thumb.addEventListener("pointerup",reset);
thumb.addEventListener("pointercancel",reset);
function reset(){
  if(dragging){
    dragging=false;
    thumb.style.left="0px";
  }
}

async function startGameFlow(){
  const duration=animateTitle();
  try{
    bootSound.currentTime=0;
    await bootSound.play();
  }catch{}
  startScreen.classList.add("hidden");
  gameContainer.classList.remove("hidden");
  setTimeout(startGame,duration);
}

/* === QUIZ LOGIC (placeholder minimal) === */
const API_URL="https://iqai-backend.vercel.app/api/quiz";
let questions=[],current=0,score=0;
let timer=null,timeLeft=30;

async function startGame(){
  current=0;score=0;
  const res=await fetch(API_URL);
  questions=await res.json();
  showQuestion();
}

function showQuestion(){
  clearInterval(timer);
  timeLeft=30;
  document.getElementById("timer").textContent=`⏱ ${timeLeft}s`;
  timer=setInterval(()=>{
    timeLeft--;
    document.getElementById("timer").textContent=`⏱ ${timeLeft}s`;
    if(timeLeft<=0){
      clearInterval(timer);
      next();
    }
  },1000);

  const q=questions[current];
  document.getElementById("questionContainer").innerHTML=q.q;
  const opts=document.getElementById("optionsContainer");
  opts.innerHTML="";
  q.options.forEach(o=>{
    const b=document.createElement("button");
    b.textContent=o;
    b.onclick=()=>{next()};
    opts.appendChild(b);
  });
}

function next(){
  current++;
  if(current<questions.length) showQuestion();
}
</script>
</body>
</html>
